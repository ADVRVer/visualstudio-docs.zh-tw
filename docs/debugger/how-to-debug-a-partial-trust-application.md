---
title: "如何：偵錯部分信任的應用程式 | Microsoft Docs"
ms.custom: ""
ms.date: "12/14/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-debug"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "FSharp"
  - "VB"
  - "CSharp"
  - "C++"
helpviewer_keywords: 
  - "偵錯 [Visual Studio], 部分信任的應用程式"
  - "部分信任的應用程式"
  - "安全性 [Visual Studio], 部分信任的應用程式"
ms.assetid: 9d30ad92-28ce-4b21-91d8-698474cddf64
caps.latest.revision: 25
caps.handback.revision: 25
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
---
# 如何：偵錯部分信任的應用程式
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

適用於 Windows 和主控台應用程式。  
  
 [ClickOnce 安全性和部署](../deployment/clickonce-security-and-deployment.md)能讓部分信任的應用程式部署方法變得更簡單，這些應用程式是利用[Code Access Security](../Topic/Code%20Access%20Security.md)制存取電腦上的資源。  
  
 偵錯部分信任的應用程式頗具挑戰性，因為根據進行安裝的來源位置不同，部分信任的應用程式也會有不同的安全性權限 \(因此行為也不同\)。  如果是從網際網路進行安裝，則部分信任的應用程式會具有較少使用權限。  如果是從近端內部網路進行安裝，則會擁有較多的使用權限。如果是從本機電腦進行安裝，則具有完整的使用權限   您可能也擁有自訂區域，這會具有自訂使用權限。  您可能必須在上述任何或所有條件下，才能偵錯部分信任的應用程式。  幸運的是，Visual Studio 也能讓這類偵錯變得更簡單。  
  
 在 Visual Studio 中啟動偵錯工作階段之前，您必須選擇要模擬為應用程式安裝來源的區域。  當您啟動偵錯時，應用程式會擁有從該區域安裝之部分信任的應用程式所適用的使用權限。  這能讓您看見應用程式的行為，這些行為會與從該區域下載該應用程式的使用者所見的一樣。  
  
 如果應用程式嘗試執行其沒有使用權限的動作，就會發生例外狀況。  這時，例外狀況助理會提供您加入額外使用權限的機會，允許您使用足夠的使用權限重新啟動偵錯工作階段，以避免這個問題。  
  
 稍候，您可以在偵錯期間返回並查看您加入了那些使用權限。  如果您在偵錯期間加入使用權限，可能會立刻指出您必須在程式碼中加入使用者同意提示。  
  
> [!NOTE]
>  偵錯工具視覺化檢視需要比部分信任應用程式所允許還要大的權限。  當您在部分信任的程式碼中被停止時，視覺化檢視將不會載入。  若要使用視覺化檢視進行偵錯，您必須以完全信任方式執行程式碼。  
  
### 若要選擇部分信任應用程式的區域  
  
1.  從 \[**專案**\] 功能表選擇 \[*Projectname* **屬性**\]。  
  
2.  在 \[*Projectname* 屬性\] 頁面中，按一下 \[**安全性**\] 頁面。  
  
3.  選取 \[**啟用 ClickOnce 安全性設定**\]。  
  
4.  在 \[**安裝應用程式的區域**\] 下，按一下下拉清單方塊，然後選擇您要模擬安裝應用程式的區域。  
  
     \[**應用程式所需的使用權限**\] 格線會顯示所有可用的使用權限。  核取記號會指出已授與應用程式的使用權限。  
  
5.  如果您選擇的區域為 \[**\(自訂\)**\]，請在 \[**使用權限**\] 格線的 \[**設定**\] 欄中選取正確的自訂設定。  
  
6.  按一下 \[**確定**\] 關閉屬性頁。  
  
### 若要在發生安全性例外狀況時加入額外使用權限  
  
1.  \[**例外狀況助理**\] 對話方塊隨即出現，並附有訊息：SecurityException 未處理。  
  
2.  在 \[**例外狀況助理**\] 對話方塊的 \[**動作**\] 下，按一下 \[**將使用權限加入專案**\]。  
  
3.  \[**重新啟動偵錯**\] 對話方塊隨即出現。  
  
    -   如果您要以新的使用權限重新啟動偵錯工作階段，請按一下 \[**是**\]。  
  
    -   如果您還不想重新啟動，請按一下 \[**否**\]。  
  
### 若要在偵錯期間檢視已加入的額外使用權限  
  
1.  從 \[**專案**\] 功能表選擇 \[*Projectname* **屬性**\]。  
  
2.  在 \[*Projectname* 屬性\] 頁面中，按一下 \[**安全性**\] 頁面。  
  
3.  查看 \[**應用程式所需的使用權限**\] 格線。  您已加入的任何額外使用權限，都會在 \[**已加入**\] 欄中擁有兩個圖示：一般核取符號和額外圖示。前者是所有已加入的使用權限都會擁有的圖示，後者的外觀像是其中包含字母 "i" 的汽球。  
  
4.  使用垂直捲軸檢視完整的 \[**應用程式所需的使用權限**\] 格線。  
  
## 請參閱  
 [ClickOnce 安全性和部署](../deployment/clickonce-security-and-deployment.md)   
 [偵錯工具安全性](../debugger/debugger-security.md)