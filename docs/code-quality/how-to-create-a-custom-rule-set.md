---
title: "如何：建立自訂規則集 | Microsoft Docs"
ms.custom: ""
ms.date: "12/16/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-devops-test"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vs.codeanalysis.addremoverulesets"
helpviewer_keywords: 
  - "Development 版，規則集"
ms.assetid: bcc42508-9592-4802-9f66-a50111641d73
caps.latest.revision: 24
caps.handback.revision: 24
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# 如何：建立自訂規則集
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

在 [!INCLUDE[vsUltShort](../code-quality/includes/vsultshort_md.md)] 、 [!INCLUDE[vsPreShort](../code-quality/includes/vspreshort_md.md)] 和 [!INCLUDE[vsPro](../code-quality/includes/vspro_md.md)] 中，您可以建立和修改自訂「*規則集*」\(Rule Set\)，以符合與程式碼分析相關聯的特定專案需求。  若要建立自訂規則集，您必須在規則集編輯器中開啟一個或多個標準規則集。  然後，您就可以加入或移除特定規則，而且您可以變更程式碼分析判斷出某項規則違規時所進行的動作。  
  
 若要建立新的自訂規則集，您必須使用新的檔案名稱來儲存。  自訂規則集會自動指派給專案。  
  
## 開啟規則集編輯器  
  
#### 若要在規則集編輯器中開啟空的規則集檔案  
  
1.  在 [!INCLUDE[vs_current_short](../code-quality/includes/vs_current_short_md.md)] 的 \[**檔案**\] 功能表上，指向 \[**新增**\]，然後按一下 \[**檔案**\]。  
  
2.  在 \[**新增檔案**\] 對話方塊中，按一下 \[**已安裝的範本**\] 清單中的 \[**一般**\]，然後選取 \[**程式碼分析規則集**\]。  
  
3.  規則集編輯器隨即出現。  在編輯器清單中沒有任何已選取的規則。  
  
#### 若要從單一現有規則集建立自訂規則  
  
1.  在 \[方案總管\] 中，以滑鼠右鍵按一下專案，然後選取 \[**屬性**\]。  
  
2.  在 \[**屬性**\] 索引標籤上，按一下 \[**程式碼分析**\]。  
  
3.  在 \[**規則集**\] 下拉式清單中，執行下列其中一項操作：  
  
    -   選取您想要自訂的規則集。  
  
     \-或\-  
  
    -   選取 \[**\<瀏覽...\>**\] 以指定不在清單中的現有規則集。  
  
4.  按一下 \[**開啟**\]，在規則集編輯器中顯示規則。  
  
#### 若要從多個現有規則集建立自訂規則集  
  
1.  在 \[方案總管\] 中，以滑鼠右鍵按一下專案，然後選取 \[**屬性**\]。  
  
2.  在 \[**屬性**\] 索引標籤上，按一下 \[**程式碼分析**\]。  
  
3.  從 \[**\<執行此規則集\>**\] 中選取 \[**\<選擇多個規則集...\>**\]。  
  
4.  在 \[**新增或移除規則集**\] 對話方塊中，選取您想要據以建立新規則集的規則集，然後按一下 \[**確定**\]。  
  
5.  儲存新的規則集。  
  
     這樣就會在 \[**執行此規則集**\] 清單中選取新規則集的名稱。  您可以在下一個步驟中變更規則集的顯示名稱。  
  
6.  \(選擇性\) 若要變更規則集的顯示名稱，請按一下 \[**檢視**\] 功能表上的 \[**屬性視窗**\]。  在 \[**名稱**\] 方塊中輸入顯示名稱。  
  
7.  若要在新的規則集中加入、移除或修改特定程式碼分析規則，請按一下 \[**開啟**\]。  
  
## 修改規則集  
  
#### 若要在規則集編輯器中修改規則集  
  
-   若要變更規則集的顯示名稱，請按一下 \[**檢視**\] 功能表上的 \[**屬性視窗**\]。  在 \[**名稱**\] 方塊中輸入顯示名稱。  請注意，顯示名稱和檔案名稱可以不相同。  
  
-   若要將群組的所有規則都加入至自訂規則集，請選取該群組的核取方塊。  若要移除群組的所有規則，請清除其核取方塊。  
  
-   若要將特定規則加入至自訂規則集，請選取該規則的核取方塊。  若要從規則集中移除規則，請清除其核取方塊。  
  
-   若要變更程式碼分析發現規則違規時所採取的動作，請按一下規則的 \[**動作**\] 欄位，然後選取下列其中一個值：  
  
     **Warn** \- 產生警告。  
  
     **Error** \- 產生錯誤。  
  
     **None** \- 停用規則。  這個動作相當於從規則集中移除規則。  
  
## 變更規則集編輯器顯示  
  
#### 若要使用規則集編輯器工具列，在規則集編輯器中分組、篩選或變更欄位  
  
-   若要展開所有群組中的規則，請按一下 \[**全部展開**\]。  
  
-   若要摺疊所有群組中的規則，請按一下 \[**全部摺疊**\]。  
  
-   若要變更規則分組依據的欄位，請從 \[**群組依據**\] 清單中選取欄位。  若要顯示未分組的規則，請選取 \[**\<無\>**\]。  
  
-   若要在規則資料行中加入或移除欄位，請按一下 \[**資料行選項**\]。  
  
-   若要隱藏不會套用至目前方案的規則，請按一下 \[**隱藏不會套用到目前方案的規則**\]。  
  
-   若要在顯示和隱藏被指派錯誤動作的規則之間切換，請按一下 \[**顯示可以產生程式碼分析錯誤的規則**\]。  
  
-   若要在顯示和隱藏被指派警告動作的規則之間切換，請按一下 \[**顯示可以產生程式碼分析警告的規則**\]。  
  
-   若要在顯示和隱藏被指派 \[**無**\] 動作的規則之間切換，請按一下 \[**顯示尚未啟用的規則**\]。  
  
-   若要在目前的規則集中加入或移除 Microsoft 預設規則集，請按一下 \[**加入或移除子規則集**\]。  
  
## 請參閱  
 [如何：設定 Managed 程式碼專案的程式碼分析](../code-quality/how-to-configure-code-analysis-for-a-managed-code-project.md)   
 [程式碼分析規則集參考](../code-quality/code-analysis-rule-set-reference.md)