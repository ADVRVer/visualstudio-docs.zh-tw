---
title: "應用程式模式適用於 Visual Studio |Microsoft 文件"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 8ed68602-4e28-46fe-b39f-f41979b308a2
caps.latest.revision: 7
ms.author: gregvanl
manager: ghogen
translation.priority.mt:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 5db97d19b1b823388a465bba15d057b30ff0b3ce
ms.openlocfilehash: 83b586273dcc60f56ad81fd451adce7860df4033
ms.lasthandoff: 02/22/2017

---
# <a name="application-patterns-for-visual-studio"></a>Visual Studio 的應用程式模式
##  <a name="a-namebkmkwindowinteractionsa-window-interactions"></a><a name="BKMK_WindowInteractions"></a>視窗互動  
  
### <a name="overview"></a>概觀  
 使用 Visual Studio 中的兩個主視窗類型是文件編輯器和工具視窗。 罕見，但可能是大型的非強制回應對話方塊。 雖然這些是在介面中所有非強制回應，其模式是本質上不同。 本主題涵蓋文件視窗、 工具視窗和非強制回應對話方塊的差異。 強制回應對話方塊模式將會涵蓋[對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Dialogs)。  
  
### <a name="comparing-window-usage-patterns"></a>比較視窗使用模式  
 **文件視窗**幾乎一定也會顯示在文件中。 這可讓文件編輯器"center 階段"周圍的補充工具視窗。  
  
 A**工具視窗**通常顯示為個別的較小的視窗 – 這可以是顯示、 隱藏或自動隱藏 – 摺疊針對 IDE 的邊緣。 不過，有時他們會看到，在文件中取消核取**停駐視窗/**視窗上的屬性。 這會導致更多的面積，但也常見設計決策︰ 正在嘗試整合到 Visual Studio，您必須決定您的功能是否應顯示工具視窗或文件視窗。  
  
 **非強制回應對話方塊**不建議在 Visual Studio 中。 大部分的情況而言，它們 – 定義 – 浮動工具視窗，並應該如此執行。 其中會太限制的殼層的側邊停駐的標準工具視窗大小的情況下可以使用非強制回應對話方塊。 它們也可以在使用者便會將對話方塊移至第二個監視器可能的情況下。  
  
 考慮仔細的容器類型的相關需要。 下表中的 UI 設計的常見使用模式考量。  
  
||文件視窗|工具視窗|非強制回應對話方塊|  
|-|---------------------|-----------------|---------------------|  
|**位置**|一律也放在文件中並不會不停駐在 ide 的邊緣。 它可以是 「 提取 」，讓它浮動分別從主要殼層。|一般索引標籤-停駐邊緣的 IDE，但可以是自訂浮點數、 自動隱藏 （不固定），或也停駐在文件中。|大型浮動視窗以外的 IDE。|  
|**認可模型**|*延遲的認可*<br /><br /> 為了將資料儲存在文件，使用者必須發出檔案/儲存、 另存新檔，或 [全部儲存] 命令。 文件視窗中可以它正在 「 變更 」 內的資料再認可至儲存的其中一個命令。 當關閉文件視窗，所有內容會儲存到磁碟或遺失。|*立即認可*<br /><br /> 沒有任何儲存模型。 偵測器工具協助您編輯檔案的視窗，必須在使用中編輯器或設計工具中，開啟檔案和編輯器或設計工具擁有儲存。|*延遲或立即認可*<br /><br /> 大多數情況下，大型的非強制回應對話方塊都需要一個動作，以認可變更，並允許 「 取消 」 作業，回復對話工作階段內的任何變更。  這項工具視窗一定會立即認可模型，會區別從 [工具] 視窗的非強制回應對話方塊。|  
|**可見性**|*開啟/建立 （檔案） 和 關閉*<br /><br /> 開啟文件視窗是透過開啟現有文件或使用範本來建立新的文件。 沒有任何 「 開啟\<特定編輯器 > 」 命令。|*隱藏和顯示*<br /><br /> 單一執行個體工具視窗可以隱藏或顯示。 內容和工具視窗中的狀態保存是否可見或隱藏。 多重執行個體工具視窗可以被關閉，以及隱藏。 當多個執行個體工具視窗關閉時，會捨棄的內容和工具視窗中的狀態。|*從命令啟動*<br /><br /> 從工作為基礎的命令啟動對話方塊。|  
|**執行個體**|*多重執行個體*<br /><br /> 雖然某些編輯器也可讓多個編輯器中開啟相同的檔案數種編輯器可同時開啟相同的時間和編輯不同的檔案 (使用**視窗 > 新視窗**命令)。<br /><br /> 單一編輯器可能正在編輯一個或多個檔案在相同的時間 （專案設計工具）。|*單一或多重 instance*<br /><br /> 內容會變更以反映內容 （如所示屬性瀏覽器），或將焦點/內容推送至其他視窗 （方案總管 中的 工作清單）。<br /><br /> 單一執行個體和多重執行個體的工具視窗應與主動式文件視窗相關聯，除非有充足的理由不到。|*單一執行個體*|  
|**範例**|**在文字編輯器**，例如程式碼編輯器<br /><br /> **設計介面**，例如表單設計工具或模型介面<br /><br /> **控制版面配置對話方塊類似**，例如資訊清單設計工具|**方案總管 中**提供一個方案和專案包含方案中<br /><br /> **伺服器總管**提供的伺服器和資料連接的使用者選擇要開啟的視窗階層式檢視。 從資料庫階層，例如查詢中，開啟物件時，會開啟文件視窗，並可讓使用者編輯查詢。<br /><br /> **屬性瀏覽器**會顯示在文件視窗或另一個工具視窗中選取物件的屬性。 屬性會顯示在階層式方格檢視中或在類似對話方塊的複雜控制項，而且可讓使用者設定這些屬性的值。||  
  
##  <a name="a-namebkmktoolwindowsa-tool-windows"></a><a name="BKMK_ToolWindows"></a>工具視窗  
  
### <a name="overview"></a>概觀  
 工具視窗支援文件視窗中發生的使用者的工作。 它們可以用來顯示代表 Visual Studio 提供，且可以操作的基本根物件的階層。  
  
 在考慮新工具視窗在 IDE 中的，作者應該︰  
  
-   使用適當的工作現有的工具視窗，並建立新的具有類似的功能。 如果他們提供明顯不同的 「 工具 」 或無法整合到類似的視窗，或是將現有視窗轉換成樞紐中心的功能只應建立新的工具視窗。  
  
-   如有需要在 [工具] 視窗頂端，請使用標準命令列。  
  
-   會使用已存在的其他工具視窗的控制簡報和鍵盤瀏覽模式一致。  
  
-   要與其他工具視窗中的控制簡報一致。  
  
-   特定文件的工具視窗應該會自動為顯示盡可能使其只在啟用父代文件時才會顯示。  
  
-   請確定其視窗的內容是可巡覽的鍵盤 （支援方向鍵）。  
  
#### <a name="tool-window-states"></a>工具視窗狀態  
 Visual Studio 工具視窗有不同的狀態，其中有些是使用者啟動 （例如 「 自動隱藏 」 功能）。 其他狀態，例如自動顯示，允許要出現在正確的內容中時不需要隱藏工具視窗。 總共有五個工具視窗狀態。  
  
-   **停駐/釘選**工具視窗可以附加至任何文件區域的四個邊。 圖釘圖示會出現在工具視窗標題列。 [工具] 視窗可停駐水平或垂直邊緣的殼層和其他工具視窗，而且也可以是標籤連結。  
  
-   **自動隱藏**工具視窗都已取消固定。 視窗可以隱密，離開 （含工具視窗的名稱和它的圖示） 的索引標籤上的文件區域的邊緣滑動。 工具視窗滑出，當使用者停留在 [] 索引標籤。  
  
-   **自動顯示**工具視窗會自動出現另一張 UI 編輯器，例如啟動或獲得焦點時。  
  
-   **浮點數**工具視窗將滑鼠游標停留在 IDE 之外。 這可用於多監視器設定。  
  
-   **索引標籤式文件**工具視窗可以停駐在文件中也。 這是適用於大型的工具視窗，例如物件瀏覽器中，需要更多的房地產比停駐在框架邊緣所允許的。  
  
 ![工具視窗狀態，在 Visual Studio 中的](../../extensibility/ux-guidelines/media/0702-01_toolwindowstates.png "0702年&01;_ToolWindowStates")  
  
 **在 Visual Studio 中的工具視窗狀態**  
  
#### <a name="single-instance-and-multi-instance"></a>單一執行個體和多重執行個體  
 工具視窗是單一執行個體或多重執行個體。 單一執行個體工具視窗可能與主動式文件視窗中，相關聯，而多個執行個體工具視窗可能不會。 藉由建立新的執行個體 視窗的視窗 / 新增 視窗中命令回應多個執行個體工具視窗。 下圖顯示使用中視窗的執行個體時啟用新視窗 」 命令的工具視窗︰  
  
 ![Visual Studio 中啟用命令的工具視窗](../../extensibility/ux-guidelines/media/0702-02_toolwindowenablingcommand.png "0702年&02;_ToolWindowEnablingCommand")  
  
 **使用中視窗的執行個體時，啟用 [新視窗] 命令的工具視窗**  
  
 單一執行個體工具視窗可以隱藏或顯示，而多個執行個體工具視窗會被關閉，還會隱藏。 所有工具視窗可以停都駐，標籤連結、 浮點數，或設定為多重文件介面 (MDI) 子視窗 （類似於文件視窗）。 所有工具視窗應該會都回應 [視窗] 功能表中的適當的視窗管理命令︰  
  
 ![在 Visual Studio 視窗管理命令](../../extensibility/ux-guidelines/media/0702-03_windowmanagementcontrols.png "0702年&03;_WindowManagementControls")  
  
 **在 Visual Studio 視窗功能表中的視窗管理命令**  
  
#### <a name="document-specific-tool-windows"></a>特定文件的工具視窗  
 某些工具視窗的設計會根據給定的文件類型而變更。 這些視窗持續更新以反映適用於在 IDE 中的主動式文件視窗的功能。  
  
 工具視窗，以反映所選的編輯器中變更其內容的範例是 [工具箱] 和文件大綱。 這些視窗會顯示浮水印編輯器有沒有提供內容視窗的焦點時。  
  
#### <a name="navigable-list-tool-windows"></a>可巡覽清單工具視窗  
 有些工具視窗會顯示使用者可以互動的可瀏覽項目清單。 在這種視窗中，應該永遠使用意見作為目前的項目在清單中，即使非使用中視窗。 清單應該會回應**GoToNextLocation**和**GoToPrevLocation**命令也會變更視窗中目前選取的項目  
  
 可巡覽清單工具視窗的範例是 [方案總管] 和 [尋找結果] 視窗。  
  
### <a name="tool-window-types"></a>工具視窗類型  
  
#### <a name="common-tool-windows-and-their-functions"></a>常見的工具視窗和它們的函式  
  
|類型|工具視窗|函式|  
|----------|-----------------|--------------|  
|**階層架構**|底下提供說明，包括方案總管|會顯示一份文件的階層樹狀結構會包含在專案、 其他檔案和方案項目。 顯示專案中的項目會定義封裝擁有專案類型 （例如，參考架構目錄為基礎或混合模式類型）。|  
|**階層架構**|類別檢視|類別和各種項目中的文件，檔案本身的獨立工作組的階層樹狀結構。|  
|**階層架構**|伺服器總管|階層樹狀結構，以顯示方案中的所有伺服器和資料連線。|  
|**階層架構**|文件大綱|主動式文件的階層式結構。|  
|**格線**|屬性|方格會顯示選取的物件，以及編輯這些屬性的值選擇器的屬性清單。|  
|**格線**|工作清單|可讓使用者建立/編輯/刪除工作和註解的方格。|  
|**內容**|說明|可讓使用者存取各種方法的說明，請從 「 如何 」 視窗 MSDN 論壇的影片。|  
|**內容**|動態說明|工具視窗會顯示說明主題適用於目前的選取範圍的連結。|  
|**內容**|物件瀏覽器|兩個資料行框架組的左的窗格中的物件屬性的階層式物件元件和右邊資料行中的方法清單。|  
|**對話方塊**|尋找]、 [進階尋找|可讓使用者尋找或尋找方案內的各種檔案中取代 對話方塊。|  
|**其他**|工具箱|用來儲存項目會放到設計介面，提供一致的拖曳來源的所有設計工具 [工具] 視窗。|  
|**其他**|起始頁|使用者入口網站至 Visual Studio 中，存取摘要的開發人員相關新聞、 Visual Studio 說明和最近使用的專案。 使用者也可以建立自訂起始頁 StartPage.xaml 檔案複製到 [startpages] 資料夾，在 Visual Studio 文件目錄中，「 Common7\IDE\StartPages\ 」 Visual Studio program files 目錄，然後以手動方式編輯 XAML，或開啟 Visual Studio 或另一個程式碼編輯器。|  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|自動變數||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|即時運算||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|輸出|只要您有文字的事件或狀態來宣告，即可使用 [輸出] 視窗。|  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|記憶體||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|中斷點||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|執行中||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|文件||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|呼叫堆疊||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|區域變數||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|監看式||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|反組譯碼||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|暫存器||  
|**偵錯工具︰**的偵錯工作和監視活動特定的 windows 群組|執行緒||  
  
##  <a name="a-namebkmkdocumenteditorconventionsa-document-editor-conventions"></a><a name="BKMK_DocumentEditorConventions"></a>文件編輯器慣例  
  
### <a name="document-interactions"></a>文件的互動  
 「 文件格式 」 是在 IDE 中的最大空間，其中使用者通常著重注意若要完成其工作，借助於補充工具視窗。 文件編輯器會代表使用者開啟和儲存在 Visual Studio 中的工作的基本單位。 在保留的強式的意義上的選取項目繫結至 [方案總管] 或其他使用中的階層架構視窗。 使用者應該能夠指向這些階層視窗，並且知道方案、 專案或 Visual Studio 封裝所提供的另一個根物件的所在文件和其關聯性。  
  
 文件編輯需要一致的使用者經驗。 若要允許使用者專注於手邊的工作而不是視窗管理和尋找命令上，選取最適合進行編輯該文件類型的使用者工作的文件檢視策略。  
  
#### <a name="common-interactions-for-the-document-well"></a>常見的互動方式，以及文件  
  
-   維護一致的互動模型的常見**新檔案**和**開啟檔案**體驗。  
  
-   文件視窗開啟時，請更新相關的視窗和功能表中的相關的功能。  
  
-   功能表命令適當地整合到常用功能表例如**編輯**，**格式**，和**檢視**功能表。 如果有大量的特殊命令，則新的功能表可以建立為可見只有當焦點在文件。  
  
-   內嵌的工具列可以置於頂端的編輯器 中。 這是有出現在編輯器之外的另一個工具列。  
  
-   永遠維持 [方案總管] 或類似的作用中的選取範圍的階層架構視窗。  
  
-   按兩下 [方案總管] 中的文件應該執行相同的動作**開啟**。  
  
-   如果多個編輯器可使用文件類型上，使用者應該能夠覆寫或重設使用給定文件類型的預設動作**開啟**檔案上按一下滑鼠右鍵，然後選取對話方塊**開啟**從捷徑功能表。  
  
-   請勿也建置文件中的精靈。  
  
### <a name="user-expectations-for-specific-document-types"></a>使用者對特定文件類型  
 有數個不同的基本類型的文件編輯器和每個都有一組一致且與相同類型的其他人互動。  
  
-   **文字編輯器︰**程式碼編輯器、 記錄檔  
  
-   **設計介面︰** WPF 表單設計工具中，Windows form  
  
-   **對話方塊樣式編輯器︰**資訊清單設計工具中，專案屬性  
  
-   **模型設計師︰**工作流程設計工具、 codemap、 架構圖、 進度  
  
 另外還有幾種使用文件的非編輯器類型。 雖然它們不會編輯文件本身，它們需要遵循標準的文件視窗的互動。  
  
-   **報表︰** IntelliTrace 報表，HYPER-V 報表，分析工具報告  
  
-   **儀表板︰**診斷中樞  
  
#### <a name="text-based-editors"></a>文字為基礎的編輯器  
  
-   文件參與預覽 索引標籤的模型，以便預覽文件，而不開啟它。  
  
-   文件的結構可能會表示小幫手 工具視窗中，例如文件大綱。  
  
-   IntelliSense （適當的話） 將會有一致的行為與其他程式碼編輯器。  
  
-   快顯視窗或輔助 UI 遵循類似的樣式和模式現有類似的 UI，例如 CodeLens。  
  
-   關於文件狀態訊息會顯示在頂端的文件的資訊列控制項，或在狀態列中。  
  
-   使用者必須能夠自訂字型和色彩使用的外觀**工具 > 選項**頁面上，共用的 [字型和色彩] 頁面或一個特定的編輯器。  
  
#### <a name="design-surfaces"></a>設計介面  
  
-   空的設計工具應該指出如何開始在介面上擁有浮水印。  
  
-   檢視切換機制會遵循現有的模式，例如連按兩下以開啟程式碼編輯器] 或 [允許具有兩個窗格的互動性的文件視窗內的索引標籤。  
  
-   將項目加入至設計介面應該透過 [工具箱] 中，除非需要非常特定的工具視窗。  
  
-   在介面上的項目會遵循一致的選取項目模型。  
  
-   內嵌的工具列包含文件特有的命令，不是常見的命令，例如**儲存**。  
  
#### <a name="dialog-style-editors"></a>對話方塊式編輯器  
  
-   控制項配置應該遵循標準的對話方塊版面配置慣例。  
  
-   在編輯器中的索引標籤應該符合文件索引標籤的外觀，它們應該符合的兩個允許的內部索引標籤樣式。  
  
-   使用者必須能夠使用鍵盤; 控制項互動是由啟動編輯器和定位停駐控制項，或使用標準的助憶鍵。  
  
-   設計工具應該使用常見的儲存模式。 沒有整體儲存或認可按鈕應放在介面中，雖然可能適合其他按鈕。  
  
#### <a name="model-designers"></a>模型設計師  
  
-   空的設計工具應該指出如何開始在介面上擁有浮水印。  
  
-   將項目加入至設計介面應該透過 [工具箱]。  
  
-   在介面上的項目會遵循一致的選取項目模型。  
  
-   內嵌的工具列包含文件特有的命令，不是常見的命令，例如**儲存**。  
  
-   圖例可能會出現在介面中，為表示或浮水印。  
  
-   使用者必須能夠使用的字型/色彩訂**工具 > 選項**頁面上，共用的 [字型和色彩] 頁面或一個特定的編輯器。  
  
#### <a name="reports"></a>報告  
  
-   報表通常資訊僅供和不參與儲存模型。 不過，它們可能包含互動功能，例如與其他相關資訊或展開和摺疊的章節連結。  
  
-   在介面上的大部分命令應該是超連結，而不是按鈕。  
  
-   配置應該包含標頭，並遵守標準報表配置。  
  
#### <a name="dashboards"></a>儀表板  
  
-   儀表板還沒互動模型本身，但是做為方法提供許多的其他工具。  
  
-   它們不會參與儲存模型。  
  
-   使用者必須能夠由啟動編輯器和 tab 鍵控制項或使用標準的助憶鍵使用鍵盤，控制項互動。  
  
##  <a name="a-namebkmkdialogsa-dialogs"></a><a name="BKMK_Dialogs"></a>對話方塊  
  
### <a name="introduction"></a>簡介  
 在 Visual Studio 中的對話方塊通常應該支援一個離散使用者的工作，然後關閉。  
  
 如果您決定您需要一個對話方塊，您有三個選項，喜好設定順序︰  
  
1.  將您的功能整合到 Visual Studio 中的 [共用] 對話方塊的其中一個。  
  
2.  建立您自己的對話方塊使用現有的類似 對話方塊中找到的模式。  
  
3.  建立新的對話方塊中，下列互動並配置指導方針。  
  
 本主題描述如何選擇正確的對話方塊模式，在 Visual Studio 工作流程和對話方塊設計的常見慣例。  
  
### <a name="themes"></a>主題  
 在 Visual Studio 中的對話方塊，請依照下列兩種基本樣式的其中一個︰  
  
#### <a name="standard-unthemed"></a>標準 (unthemed)  
 對話的多數標準公用程式的對話方塊，以及應該 unthemed。 請勿不 re 範本通用控制項，或嘗試建立樣式化的 「 現代化 」 按鈕或控制項。 控制項和 chrome 外觀，請遵循[對話方塊的標準 Windows 桌面互動方針](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742499\(v=vs.85\).aspx)。  
  
#### <a name="themed"></a>佈景主題  
 特殊的 「 簽章 」 對話方塊可能佈景主題。 佈景主題對話方塊有不同的外觀，也有一些特殊的互動模式中相關聯的樣式。 佈景主題對話方塊只有在符合下列需求︰  
  
-   對話是通用的操作，將會出現，且通常或許多使用者使用 (例如，**新的專案** 對話方塊。  
  
-   此對話方塊包含提供顯著的產品品牌項目 (例如，**帳戶設定**對話方塊)。  
  
-   對話方塊會顯示為較大的流程，其中包含其他主題的對話方塊中不可或缺的一部分 (例如，**加入已連接服務**對話方塊)。  
  
-   對話方塊是經驗的扮演策略性的角色中升級或與眾不同的產品版本很重要的一部分。  
  
 在建立佈景主題對話方塊時，使用適當的環境色彩，並遵循正確的版面配置和互動模式。 (請參閱[for Visual Studio 的版面配置](../../extensibility/ux-guidelines/layout-for-visual-studio.md))  
  
### <a name="dialog-design"></a>對話方塊設計  
 設計良好的對話方塊會考慮到下列項目︰  
  
-   所支援的使用者工作  
  
-   對話方塊文字樣式、 語言和術語  
  
-   控制項選擇與 UI 慣例  
  
-   視覺化版面配置規格和控制項的對齊方式  
  
-   存取鍵盤  
  
#### <a name="content-organization"></a>內容的組織  
 請考慮這些基本類型的對話方塊之間的差異︰  
  
-   [簡單對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_SimpleDialogs)呈現單一的強制回應視窗中的控制項。 此份簡報可能包含複雜的控制項模式，包括欄位選擇器或圖示列的變化。  
  
-   [分層對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_LayeredDialogs)用來獲得最佳的實際螢幕面積，當 UI 的一個片段包含多個控制項群組。 對話方塊群組 「 層 」 透過索引標籤控制項、 瀏覽清單控制項或按鈕，讓使用者可以選擇在任何給定時刻查看哪一個群組。  
  
-   [精靈](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Wizards)會引導使用者進行一連串的步驟以完成工作的邏輯很有用。 一系列選項所提供之循序的面板，有時也導入不同的工作流程 （「 分支 」） 是在前一個面板中所做的選擇而定。  
  
####  <a name="a-namebkmksimpledialogsa-simple-dialogs"></a><a name="BKMK_SimpleDialogs"></a>簡單對話方塊  
 簡單的對話方塊是在單一的強制回應視窗控制項的呈現方式。 這份簡報可能包含複雜的控制項模式，例如欄位選擇器的變化。 對於簡單的對話，遵循標準的一般配置，以及任何特定的版面配置所需的複雜控制項群組。  
  
 ![在 Visual Studio 中的簡單對話方塊](../../extensibility/ux-guidelines/media/0704-01_createstrongnamekey.png "0704年&01;_CreateStrongNameKey")  
  
 **建立強式名稱金鑰是一個簡單的對話方塊，在 Visual Studio 中的範例。**  
  
####  <a name="a-namebkmklayereddialogsa-layered-dialogs"></a><a name="BKMK_LayeredDialogs"></a>多層式的對話方塊  
 分層的對話方塊含有索引標籤、 儀表板和內嵌的樹狀結構。 它們用來最大化不動產，當有多個群組的單一的 UI 中提供的控制項。 群組是有層次，讓使用者選擇哪一個群組，若要查看一次。  
  
 在最簡單的情況下，群組之間切換的機制是索引標籤控制項。 有多個替代方案。 請參閱 Prioritizing 和圖層如何選擇最適當的樣式。  
  
 **工具 > 選項**對話方塊是使用內嵌的樹狀結構的分層對話方塊的範例︰  
  
 ![在 Visual Studio 中的分層的對話方塊](../../extensibility/ux-guidelines/media/0704-02_toolsoptions.png "0704年&02;_ToolsOptions")  
  
 **工具 > 選項是在 Visual Studio 中的分層對話方塊的範例。**  
  
####  <a name="a-namebkmkwizardsa-wizards"></a><a name="BKMK_Wizards"></a>精靈  
 精靈會引導使用者完成邏輯的一連串的步驟中完成工作有用。 循序的面板中所提供的一系列選項，使用者必須完成每個步驟再繼續進行到下一步 繼續。 一旦有足夠的預設值可供使用，**完成**按鈕啟用。  
  
 強制回應精靈用於工作的︰  
  
-   包含分支，會根據使用者選擇提供給不同的路徑  
  
-   包含兩個步驟，後續的步驟會視先前步驟的使用者輸入的相依性  
  
-   夠複雜的 UI 應該用來說明提供的選擇，以及每一個步驟中可能的結果  
  
-   為交易式，需要一組已完成整個認可任何變更之前的步驟  
  
### <a name="common-conventions"></a>常見的慣例  
 為了達到最佳設計和功能與您的對話方塊，請在對話方塊的大小、 位置、 標準、 控制項設定和對齊方式、 UI 文字、 標題列、 控制按鈕和存取金鑰遵循下列慣例。  
  
 配置特定指導方針，請參閱[for Visual Studio 的版面配置](../../extensibility/ux-guidelines/layout-for-visual-studio.md)。  
  
#### <a name="size"></a>大小  
 對話方塊應該符合最小的 1024 x 768 螢幕解析度，以及初始的對話方塊大小不得超過 900 x 700 像素為單位。 對話方塊可能會調整大小，但不一定需要。  
  
 有兩個建議可調整大小的對話方塊︰  
  
1.  最小大小所定義的對話方塊，將最佳化的控制項集合，而不裁剪，調整以因應成長合理的當地語系化。  
  
2.  使用者調整大小會保存工作階段。 比方說，如果使用者比例 150% 對話方塊，後續啟動的對話方塊會顯示在 150%。  
  
#### <a name="position"></a>位置  
 對話方塊必須出現在第一次啟動 IDE 中置中。 對於非可調整大小的對話，並不需要保存 [] 對話方塊中的最後一個位置，就會出現在後續啟動上置中。 對於可調整大小的對話，大小應保存在後續的啟動。 對於強制回應的可調整大小對話，位置不需要保存。 顯示在 IDE 中置中對齊它們，可以避免不斷變更使用者的顯示設定時，無法預期或無法使用的位置中出現的對話方塊。 可以重新定位的非強制回應對話方塊，使用者的位置應該維持在後續的啟動可能經常使用的對話方塊，為較大的工作流程中不可或缺的一部分。  
  
 當對話方塊必須產生其他對話方塊時，最上層 對話方塊應該右邊會重疊顯示、 向下，從父代，使其容易使用的使用者，他們已經看過新的位置。  
  
#### <a name="modality"></a>強制回應性  
 正在強制回應，表示使用者就必須完成或取消對話方塊，然後再繼續。 由於強制回應對話方塊封鎖使用者互動的環境的其他部分，功能的工作流程應該盡可能謹慎使用。 當需要獨佔式作業時，Visual Studio 就會有一些共用的對話方塊，您可以整合到您的功能。 如果您必須建立新的對話方塊，請遵循現有的對話的互動模式具有類似的功能。  
  
 當使用者需要執行兩個活動在一次，例如**尋找**和**取代**時撰寫新程式碼，對話方塊應該為非強制回應，讓使用者輕鬆地切換它們。 Visual Studio 通常會使用這種編輯器支援已連結的工作的工具視窗。  
  
#### <a name="control-configuration"></a>控制組態  
 要達成相同的效果，Visual Studio 中的現有控制項設定一致。  
  
#### <a name="title-bars"></a>標題列  
  
-   標題列中的文字必須反映命令啟動它的名稱。  
  
-   無圖示應該用於對話方塊標題列。 系統需要的其中一個情況下，使用 Visual Studio 標誌。  
  
-   對話方塊不應該有最小化或最大化按鈕。  
  
-   標題列中的 [說明] 按鈕已被取代。 不將它們加入新的對話方塊。 當它們存在的話時，他們應該啟動工作在概念上相關 [說明] 主題。  
  
 ![標題列規格，Visual Studio](../../extensibility/ux-guidelines/media/0704-03_titlebarspecs.png "0704年&03;_TitleBarSpecs")  
  
 **Visual Studio 對話方塊中的標題列的指導方針規格。**  
  
#### <a name="control-buttons"></a>控制按鈕  
 一般而言，**確定**/**取消**/**協助**應該水平排列按鈕，在對話方塊右下角。 如果對話方塊有數個其他按鈕會呈現視覺混淆在一起的控制按鈕的對話方塊底部，並允許替代垂直堆疊。  
  
 ![控制 Visual Studio 中的按鈕組態](../../extensibility/ux-guidelines/media/0704-04_controlbuttonconfig.png "0704年&04;_ControlButtonConfig")  
  
 **可接受 Visual Studio 對話方塊中的控制項按鈕組態**  
  
 對話方塊中，必須加入預設控制按鈕。 若要判斷最佳的命令，以做為預設值，選擇下列選項 （依照優先順序列出）︰  
  
-   選擇最安全且最安全的命令為預設值。 這表示選擇最有可能導致資料遺失，並避免非預期的系統存取命令。  
  
-   如果資料遺失與安全性不因素，然後選擇以方便的預設命令。 包括最有可能的命令為預設值將可改善使用者的工作流程時對話方塊支援經常或重複的工作。  
  
 避免選擇預設命令的永久破壞性動作。 如果存在這類的命令，改以更安全的命令為預設值。  
  
#### <a name="access-keys"></a>便捷鍵  
 請勿使用便捷鍵**確定**/**取消**/**協助**按鈕。 根據預設，這些按鈕會對應至快速鍵︰  
  
|按鈕名稱|鍵盤快速鍵|  
|-----------------|-----------------------|  
|確定|Enter|  
|取消|Esc|  
|說明|F1|  
  
#### <a name="imagery"></a>圖像  
 在對話方塊中，謹慎地使用映像。 請勿在對話方塊中使用大圖示，只是要使用空間。 使用映像，才會傳達給使用者，例如警告圖示或狀態動畫訊息很重要的一部分。  
  
###  <a name="a-namebkmkprioritizingandlayeringa-prioritizing-and-layering"></a><a name="BKMK_PrioritizingAndLayering"></a>設定優先順序和分層  
  
#### <a name="prioritizing-your-ui"></a>排列優先順序 UI  
 它可能需要讓 forefront 特定 UI 項目，並將更進階的行為和到對話方塊選項 （包括難以理解的命令）。 留出空間，並讓它顯示在 UI 中的文字標籤的預設顯示對話方塊時，將 forefront 常用的功能。  
  
#### <a name="layering-your-ui"></a>分層 UI  
 如果您決定對話是必要，但您想要呈現給使用者的相關的功能其實不僅簡單的對話方塊中顯示內容，您需要將您的 UI 層級。 Visual Studio 會使用最常見的分層方法是索引標籤和晃或儀表板。 在某些情況下，可能適合可以展開和摺疊的區域。 在 Visual Studio 中通常不建議自動調整 UI。  
  
 有其優點和缺點的分層 UI 透過類似索引標籤控制項的不同方法。 檢閱下列清單以確定您選擇適合您情況的分層技術。  
  
##### <a name="tabbing"></a>按下 tab 鍵  
  
|交換機制|優點和適當用法|缺點和不當使用|  
|-------------------------|------------------------------------|-----------------------------------------|  
|索引標籤控制項|以邏輯方式分組到相關集的 對話方塊頁面<br /><br /> 適用於少於五個 （或在一個資料列容納在整個對話的標籤數目） 相關的控制項在對話方塊中的頁面<br /><br /> 索引標籤必須簡短︰ 可以輕鬆地識別內容的一個或兩個字<br /><br /> 常見的系統對話方塊樣式<br /><br /> 範例︰**檔案總管 > 項目屬性**|很難進行簡短的描述性標籤<br /><br /> 通常不超過五個索引標籤，在一個對話方塊中調整<br /><br /> 如果您有一個資料列; 太多索引標籤不正確使用替代的分層技術<br /><br /> 不是可延伸|  
|提要欄位巡覽|簡單的切換裝置可以容納更多的類別，比索引標籤<br /><br /> 一般清單的類別 （沒有階層）<br /><br /> 可延伸<br /><br /> 範例︰ **...自訂 > 加入命令**|不適合用於有少於三個群組的水平空間<br /><br /> 工作可能會更適合於下拉式清單|  
|樹狀控制項|允許無限制的類別<br /><br /> 允許群組和/或階層架構的分類<br /><br /> 可延伸<br /><br /> 範例︰**工具 > 選項**|大量巢狀的階層，可能會造成過多的水平捲軸<br /><br /> Visual Studio 有農民的樹狀檢視|  
|精靈|協助引導完成工作為基礎的循序步驟的工作完成。 精靈表示高階工作和個別面板代表完成整體工作所需的子工作。<br /><br /> 當工作跨越 Ui 界限，做為當使用者原本必須使用多個編輯器和工具視窗來完成工作時很有用<br /><br /> 此工作需要分支的用途<br /><br /> 當工作包含兩個步驟的相依性時很有用<br /><br /> 可以呈現一個對話方塊，以減少不同的類似對話方塊的數個與一個決定分岔的類似工作時很有用。|不適用於任何工作，不需要的循序工作流程<br /><br /> 使用者只能成為混亂且混淆太多步驟的精靈<br /><br /> 精靈本質上具有有限的螢幕畫面|  
  
##### <a name="hallways-or-dashboards"></a>晃或儀表板  
 晃和儀表板是對話或做為啟動指向其他對話方塊和視窗的面板。 只有最常見的選項、 命令和設定，讓使用者能夠輕易地完成一般工作會立即呈現，設計良好的 「 我們 」。 像實際的走廊提供通往存取後面房間，這裡較不常見 UI 收集到個別 「 室 」 （通常是其他對話方塊） 相關的功能，可從主要的走廊存取。  
  
 或者，提供單一集合中所有可用的功能，而非重整成不同的位置較不常見的功能，就只需儀表板 UI。  
  
 ![在 Outlook 中的 hallway 概念](../../extensibility/ux-guidelines/media/0704-08_hallway.png "0704年&08;_Hallway")  
  
 **公開額外的 UI，在 Outlook 中的 hallway 概念**  
  
##### <a name="adaptive-ui"></a>彈性的 UI  
 顯示或隱藏 UI 根據使用量或報告的使用者體驗是另一種必要的 UI 呈現時隱藏其他部分。 建議您不要在 Visual Studio 中的演算法來決定何時要顯示或隱藏 UI 可能需要一點技巧，以及規則一定就會出錯的一些案例集。  
  
##  <a name="a-namebkmkprojectsa-projects"></a><a name="BKMK_Projects"></a>專案  
  
### <a name="projects-in-the-solution-explorer"></a>在 [方案總管] 中的專案  
 大部分專案都會分類為參考為基礎，目錄架構或混合。 在 [方案總管] 中同時支援這三種專案類型。 使用專案中的使用者經驗的根目錄會發生在此視窗。 雖然不同的專案節點的參考、 目錄或混合模式類型的專案，還有常見的互動模式應套用做為起點之前為分散到專案特定的使用者模式。  
  
 專案應該永遠︰  
  
-   支援的功能加入專案資料夾來組織專案內容  
  
-   維護一致的模型專案持續性  
  
 專案也應維護一致的互動的模型︰  
  
-   移除專案項目  
  
-   儲存文件  
  
-   專案屬性編輯  
  
-   編輯另一種檢視中的專案  
  
-   拖放作業  
  
### <a name="drag-and-drop-interaction-model"></a>拖放互動模型  
 專案通常分類本身做為參考為基礎 （能夠保留儲存體中的專案項目的唯一參考），目錄架構 （能夠實際保留唯一的專案項目儲存在專案階層），或混合的 （無法保存參考或實體的項目）。 IDE 同時內可容納所有三種專案類型**方案總管 中**。  
  
 拖放的觀點而言，下列的特性應套用至專案內的每一種**方案總管 中**:  
  
-   **參考為基礎的專案︰**的重點是專案會參考儲存體中的項目周圍拖曳。 當參考為基礎的專案做為移動作業的來源時，它應該只移除專案項目的參考。 項目不應實際刪除從硬碟機。 當參考為基礎的專案做為移動 （或複製） 作業的目標時，它應該不做任何私用複本的項目加入至原始的來源項目參考。  
  
-   **目錄架構的專案︰**拖放的觀點而言，從專案實體的項目，而不是參考周圍拖曳。 當目錄為基礎的專案做為移動作業的來源時，它應該結束從硬碟中刪除實體的項目，以及從專案中移除。 目錄為基礎的專案做為移動 （或複製） 作業的目標，它應提出一份來源項目在其目標位置。  
  
-   **混合目標專案︰**拖放的觀點而言，從這個專案類型的行為為基礎的本質 （儲存體中的項目參考），或是在項目本身被拖曳的項目。 上面說明了正確的行為的參考和實體的項目。  
  
 如果有個專案中的一種**方案總管 中**，拖放作業將會直接了當。 因為每個專案系統定義它自己的拖放行為的能力，以確保可預測的使用者經驗，應遵循 （根據 Windows 檔案總管 拖放行為） 的特定指導方針︰  
  
-   修改拖曳作業**方案總管 中**（當 Ctrl 或 Shift 鍵都不會同時按住） 應該會導致移動作業。  
  
-   Shift 拖曳作業應該也會導致移動作業。  
  
-   Ctrl 拖曳作業應該會導致複製作業。  
  
-   參考架構和混合專案系統支援來源項目加入連結 （或參考） 的概念。 當這些專案會拖放作業的目標 (當**Ctrl + Shift**按住)，它應該會導致項目加入專案的參考  
  
 並非所有的拖放作業的參考架構目錄為基礎，並混合專案組合值是合理的做法。 特別是，會有問題，假裝為允許目錄為基礎的原始碼專案和參考為基礎的目標專案之間移動作業，因為來源目錄為基礎的專案就必須刪除完成移動時的來源項目。 目標參考架構專案然後最後可能已刪除項目的參考。  
  
 也很容易讓人誤解，假裝為允許這些類型的專案之間複製作業，因為目標參考架構專案，最好不要的獨立複本的來源項目。 同樣地，Ctrl + Shift 拖曳至目錄為基礎的目標專案不被允許，因為目錄為基礎的專案是無法保存參考。 IDE 應該在其中拖放作業不支援的情況下，不允許卸除，並顯示使用者不置放游標 （指標在下表中所示）。  
  
 若要正確實作拖放行為，請拖曳的原始碼專案必須通訊本質上 （例如，這是參考或目錄為基礎？） 對目標專案。 這項資訊會以由來源所提供的剪貼簿格式。 專案應該做為來源拖曳 （或剪貼簿複製作業） 提供其中**CF_VSREFPROJECTITEM**S 或**CF_VSSTGPROJECTITEMS**分別根據專案是參考或目錄為基礎。 這些格式都有相同的資料內容，類似於 Windows **CF_HDROP**格式不同之處在於的字串，而不是檔名的清單是 double-**NULL**終止清單**Projref**字串 (傳回的**IVsSolution::GetProjrefOfItem**或**:: GetProjrefOfProject**視需要)。  
  
 為卸除 （或剪貼簿貼上作業） 的目標，專案應該接受兩者**CF_VSREFPROJECTITEMS**和**CF_VSSTGPROJECTITEMS**，不過確切處理拖放作業的目標專案和原始碼專案的本質而異。 原始碼專案所是否提供宣告本質**CF_VSREFPROJECTITEMS**或**CF_VSSTGPROJECTITEMS**。 卸除目標了解它自己的本質，並因此具有足夠資訊來做出決策，以做為，是否移動、 複製、 或應執行的連結。 使用者也會修改哪個拖放作業應該由按下 Ctrl、 Shift 或 Ctrl 和 Shift 鍵。 請務必正確地表示會在預先執行哪些作業的置放目標其**DragEnter**和**拖曳經過時顯示**方法。 **方案總管] 中**會自動獲知 [原始碼專案和目標專案是否在同一個專案。  
  
 特別是不支援拖曳的 Visual Studio 執行個體上的專案項目 （例如，從 devenv.exe 到另一個執行個體）。 **方案總管 中**這也會直接停用。  
  
 使用者應該永遠能夠判斷所選取項目、 將它拖曳到目標位置，並觀察出現在卸除項目之前的下列滑鼠指標的拖放作業的效果︰  
  
|滑鼠指標|命令|描述|  
|-------------------|-------------|-----------------|  
|![滑鼠 「 不置放 」 圖示](../../extensibility/ux-guidelines/media/0706-01_mousenodrop.png "0706年&01;_MouseNoDrop")|不卸除|無法卸除項目至指定的位置。|  
|![滑鼠 「 複製 」 圖示](../../extensibility/ux-guidelines/media/0706-02_mousecopy.png "0706年&02;_MouseCopy")|複製|項目會複製到目標位置。|  
|![滑鼠 「 移動 」 圖示](../../extensibility/ux-guidelines/media/0706-03_mousemove.png "0706年&03;_MouseMove")|Move|項目會移到目標位置。|  
|![滑鼠 「 加入參考 」 圖示](../../extensibility/ux-guidelines/media/0706-04_mouseaddref.png "0706年&04;_MouseAddRef")|加入參考|選取的項目參考會加入到目標位置。|  
  
#### <a name="reference-based-projects"></a>參考為基礎的專案  
 下表摘要說明拖放 （以及剪下/複製/貼上） 執行的作業應該根據來源項目和修飾詞索引鍵參考為基礎的目標專案的已按下性質︰  
  
|||來源項目︰ 參考/連結|來源項目︰ 實體項目或檔案系統 (CF_HDROP)|  
|-|-|----------------------------------|-------------------------------------------------------------|  
|任何修飾詞|動作|Move|連結|  
|任何修飾詞|目標|將參考加入至原始項目|將參考加入至原始項目|  
|任何修飾詞|來源|刪除原始項目的參考|會保留原始的項目|  
|任何修飾詞|結果|**DROPEFFECT_MOVE**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**DROPEFFECT_LINK**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|Shift + 拖曳|動作|Move|不卸除|  
|Shift + 拖曳|目標|將參考加入至原始項目|不卸除|  
|Shift + 拖曳|來源|刪除原始項目的參考|不卸除|  
|Shift + 拖曳|結果|**DROPEFFECT_MOVE**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|不卸除|  
|Ctrl + 拖曳|動作|複製|不卸除|  
|Ctrl + 拖曳|目標|將參考加入至原始項目|不卸除|  
|Ctrl + 拖曳|來源|會保留原始的項目參考|不卸除|  
|Ctrl + 拖曳|結果|**DROPEFFECT_COPY**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|不卸除|  
|Ctrl + Shift + 拖曳|動作|連結|連結|  
|Ctrl + Shift + 拖曳|目標|將參考加入至原始項目|將參考加入至原始項目|  
|Ctrl + Shift + 拖曳|來源|會保留原始的項目參考|會保留原始的項目|  
|Ctrl + Shift + 拖曳|結果|**DROPEFFECT_LINK**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**DROPEFFECT_LINK**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|Ctrl + Shift + 拖曳|注意事項|在 Windows 檔案總管的捷徑的拖放行為相同。||  
|剪下/貼上|動作|Move|連結|  
|剪下/貼上|目標|將參考加入至原始項目|將參考加入至原始項目|  
|剪下/貼上|來源|會保留原始的項目參考|會保留原始的項目|  
|剪下/貼上|結果|項目會保留在儲存體中的原始位置|項目會保留在儲存體中的原始位置|  
|複製/貼上|動作|複製|連結|  
|複製/貼上|來源|將參考加入至原始項目|將參考加入至原始項目|  
|複製/貼上|結果|會保留原始的項目參考|會保留原始的項目|  
|複製/貼上|動作|項目會保留在儲存體中的原始位置|項目會保留在儲存體中的原始位置|  
  
#### <a name="directory-based-projects"></a>目錄架構專案  
 下表摘要說明拖放 （以及剪下/複製/貼上） 執行的作業應該根據目錄為基礎的目標專案的已按下的來源項目和修飾詞金鑰性質︰  
  
|||來源項目︰ 參考/連結|來源項目︰ 實體項目或檔案系統 (CF_HDROP)|  
|-|-|----------------------------------|-------------------------------------------------------------|  
|任何修飾詞|動作|Move|Move|  
|任何修飾詞|目標|複製到目標位置的項目|複製到目標位置的項目|  
|任何修飾詞|來源|刪除原始項目的參考|刪除原始項目的參考|  
|任何修飾詞|結果|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|Shift + 拖曳|動作|Move|Move|  
|Shift + 拖曳|目標|複製到目標位置的項目|複製到目標位置的項目|  
|Shift + 拖曳|來源|刪除原始項目的參考|從原始位置刪除項目|  
|Shift + 拖曳|結果|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|Ctrl + 拖曳|動作|複製|複製|  
|Ctrl + 拖曳|目標|複製到目標位置的項目|複製到目標位置的項目|  
|Ctrl + 拖曳|來源|會保留原始的項目參考|會保留原始的項目參考|  
|Ctrl + 拖曳|結果|**DROPEFFECT_ 複製**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**DROPEFFECT_ 複製**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|Ctrl + Shift + 拖曳||不卸除|不卸除|  
|剪下/貼上|動作|Move|Move|  
|剪下/貼上|目標|複製到目標位置的項目|複製到目標位置的項目|  
|剪下/貼上|來源|刪除原始項目的參考|從原始位置刪除項目|  
|剪下/貼上|結果|項目會保留在儲存體中的原始位置|從儲存體中的原始位置刪除項目|  
|複製/貼上|動作|複製|複製|  
|複製/貼上|目標|將參考加入至原始項目|複製到目標位置的項目|  
|複製/貼上|來源|會保留原始的項目|會保留原始的項目|  
|複製/貼上|結果|項目會保留在儲存體中的原始位置|項目會保留在原始位置單元存放裝置|  
  
#### <a name="mixed-target-projects"></a>混合目標專案  
 下表摘要說明拖放 （以及剪下/複製/貼上） 執行的作業應該根據性質的混合目標專案的已按下的來源項目和修飾詞索引鍵︰  
  
|||來源項目︰ 參考/連結|來源項目︰ 實體項目或檔案系統 (CF_HDROP)|  
|-|-|----------------------------------|-------------------------------------------------------------|  
|任何修飾詞|動作|Move|Move|  
|任何修飾詞|目標|將參考加入至原始項目|複製到目標位置的項目|  
|任何修飾詞|來源|刪除原始項目的參考|刪除原始項目的參考|  
|任何修飾詞|結果|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**項目會從儲存體中的原始位置刪除|  
|Shift + 拖曳|動作|Move|Move|  
|Shift + 拖曳|目標|將參考加入至原始項目|複製到目標位置的項目|  
|Shift + 拖曳|來源|刪除原始項目的參考|從原始位置刪除項目|  
|Shift + 拖曳|結果|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**移動 DROPEFFECT_**傳回做為動作從**:: 卸除**項目會從儲存體中的原始位置刪除|  
|Ctrl + 拖曳|動作|複製|複製|  
|Ctrl + 拖曳|目標|將參考加入至原始項目|複製到目標位置的項目|  
|Ctrl + 拖曳|來源|會保留原始的項目參考|會保留原始的項目|  
|Ctrl + 拖曳|結果|**DROPEFFECT_ 複製**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**DROPEFFECT_ 複製**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|Ctrl + Shift + 拖曳|動作|連結|連結|  
|Ctrl + Shift + 拖曳|目標|將參考加入至原始項目|將參考加入至原始的來源項目|  
|Ctrl + Shift + 拖曳|來源|會保留原始的項目參考|會保留原始的項目|  
|Ctrl + Shift + 拖曳|結果|**DROPEFFECT_ 連結**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|**DROPEFFECT_ 連結**傳回做為動作從**:: 卸除**和項目會保留在儲存體中的原始位置|  
|剪下/貼上|動作|Move|Move|  
|剪下/貼上|目標|複製到目標位置的項目|複製到目標位置的項目|  
|剪下/貼上|來源|刪除原始項目的參考|從原始位置刪除項目|  
|剪下/貼上|結果|項目會保留在儲存體中的原始位置|從儲存體中的原始位置刪除項目|  
|複製/貼上|動作|複製|複製|  
|複製/貼上|目標|將參考加入至原始項目|複製到目標位置的項目|  
|複製/貼上|來源|會保留原始的項目|會保留原始的項目|  
|複製/貼上|結果|項目會保留在儲存體中的原始位置|項目會保留在儲存體中的原始位置|  
  
 這些詳細資料應該列入考量實作拖曳時**方案總管 中**:  
  
-   多個選取項目案例的設計。  
  
-   在 目標專案檔案名稱 （完整路徑） 必須是唯一或卸除不被允許。  
  
-   必須是唯一的資料夾名稱 （區分大小寫） 正在捨棄層級。  
  
-   行為之間有差異時 （在上述案例中不會提到） 將會開啟或關閉的檔案。  
  
-   最上層檔案的行為稍有不同資料夾中的檔案。  
  
 要注意的另一個問題是如何處理已開啟的設計工具或編輯器中的項目上的移動作業。 預期的行為是，如下所示 （這適用於所有專案類型）︰  
  
1.  如果開啟編輯器/設計工具並沒有任何未儲存的變更，然後編輯器/設計工具 視窗應該會以無訊息模式關閉。  
  
2.  如果開啟編輯器/設計工具具有未儲存的變更，在拖曳來源應該等候以發生然後要求使用者儲存開啟的文件中未認可的變更，關閉視窗，如下所示的提示之前卸除︰  
  
    ```  
    ==========================================================   
         One or more open documents have unsaved changes.  
    Do you want to save uncommitted changes before proceeding?   
                      [Yes]  [No]  [Cancel]   
    ==========================================================  
    ```  
  
 這樣使用者就可以進行中的工作前先加以儲存目標會建立其複本。 新方法**IVsHierarchyDropDataSource2::OnBeforeDropNotify**已新增至啟用這項處理。  
  
 目標會然後複製項目的狀態，因為它是在儲存體 (不包含未儲存的變更在編輯器中，如果使用者選擇**否**)。 目標已完成其複製之後 (在**IVsHierarchyDropDataSource::Drop**)，來源就有機會完成移動作業的刪除部分 (在**IVsHierarchyDropDataSource::OnDropNotify**)。  
  
 任何未儲存的變更與編輯器應該處於開啟狀態。 如有變更尚未儲存這些文件，這表示將會執行移動作業中複製的一部分，但刪除部分將會中止。 在多選取當使用者選擇**否**，且未儲存變更這些文件不應該關閉或移除，但不含未儲存的變更應該關閉並移除。
