---
title: "測試區 5︰ 變更原始檔控制 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "變更原始檔控制 [Visual Studio SDK]，"
  - "原始檔控制外掛程式，變更原始檔控制"
ms.assetid: fdf09e00-108c-4d51-bbd5-72452d52a490
caps.latest.revision: 15
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 15
---
# 測試區 5︰ 變更原始檔控制
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

此原始檔控制外掛程式的測試區域涵蓋變更原始檔控制，透過 **變更原始檔控制** 命令。  
  
 **變更原始檔控制** 命令為使用者提供四種基本功能︰  
  
-   **繫結︰**  
  
     可讓使用者建立或重新建立原始檔控制與之間的連結方案\/專案版本儲存區。  
  
-   **解除繫結︰**  
  
     移除每個連線為基礎的原始檔控制專案\/方案。  
  
-   **連線\/中斷連線︰**  
  
 切換連線或離線狀態的受控制的方案，涵蓋區域 3。 如需詳細資訊，請參閱[測試區 3︰ 簽出\/復原簽出](../../extensibility/internals/test-area-3-check-out-undo-checkout.md)。  
  
## 命令功能表存取  
 下列 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] 的測試案例中使用整合式的開發環境\] 功能表上的路徑。  
  
 變更原始檔控制︰**檔案**, ，**原始檔控制**, ，**變更原始檔控制**。  
  
## 測試案例  
 以下是針對特定測試案例 **變更原始檔控制** 命令測試區域。  
  
### Case 5a︰ 繫結  
 繫結可讓使用者將來源的程式碼控制資訊加入至選取的專案和方案。 若要識別這些要新增的原始檔控制中的專案通常提示使用者。 這項作業 （與加入至原始檔控制的對比） 一部分的原始檔控制中，使用者可能無法建立新的專案。  
  
|動作|測試步驟|若要確認預期的結果|  
|--------|----------|---------------|  
|繫結至空的位置|1.  建立專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  開啟 **變更原始檔控制** 對話方塊 \(**檔案**, ，**原始檔控制**, ，**變更原始檔控制**\)。<br />4.  按一下 \[ **解除繫結**。<br />5.  如果有出現，請接受警告對話方塊。<br />6.  選取所有項目。<br />7.  按一下 \[ **繫結**。<br />8.  瀏覽至原始檔控制存放區中的空白位置。<br />9. 按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />10. 按一下 \[ **繼續使用這些繫結** 在確認對話方塊。<br />11. 按一下 \[ **確定** 警告對話方塊中顯示。<br />12. 簽入所有檔案。 如果這個步驟成功，請繼續下一個步驟。<br />13. 新的位置，從原始檔控制開啟方案。|`Result from Step 12:`<br /><br /> 方案和專案繫結至並寫入至新的目標版本存放區中。<br /><br /> 方案和專案檔案已簽入。<br /><br /> 版本存放區專案階層架構會比對專案在磁碟上的資料夾階層。<br /><br /> `Result from Step 13:`<br /><br /> 下載專案的所有項目。|  
|繫結至用戶端同步的位置|1.  建立專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  在版本存放區中建立方案和專案的複本 \(共用和分支，如果使用 [!INCLUDE[vsvss](../../extensibility/includes/vsvss_md.md)]\)。<br />4.  開啟 **變更原始檔控制** 對話方塊 \(**檔案**, ，**原始檔控制**, ，**變更原始檔控制**\)。<br />5.  解除所有繫結。<br />6.  按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />7.  重新開啟 **變更原始檔控制** 對話方塊。<br />8.  選取 \[全部。<br />9. 按一下 \[ **繫結**。<br />10. 瀏覽至方案和專案的分支位置 （從步驟 3）<br />11. 按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />12. 取得最新的遞迴的所有項目。|Get 之後在開始之前相同的檔案內容。|  
|繫結至與用戶端同步處理的位置|1.  建立專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  在版本存放區中建立方案和專案的複本 \(共用和分支，如果使用 [!INCLUDE[vsvss](../../extensibility/includes/vsvss_md.md)]\)。<br />4.  修改分支的專案版本儲存區中的檔案。<br />5.  開啟 **變更原始檔控制** 對話方塊 \(**檔案**, ，**原始檔控制**, ，**變更原始檔控制**\)。<br />6.  解除所有繫結。<br />7.  按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />8.  重新開啟 **變更原始檔控制** 對話方塊。<br />9. 選取 \[全部。<br />10. 按一下 \[ **繫結**。<br />11. 瀏覽至分支方案和專案的位置。<br />12. 按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />13. 如果有出現，請接受警告對話方塊。<br />14. 取得最新的遞迴的所有項目。|在步驟 4 中已修改的檔案也會在本機修改。|  
|繫結永遠不會受到原始檔控制的方案|1.  原始檔控制中建立空的資料夾。<br />2.  建立用戶端專案。<br />3.  開啟 **變更原始檔控制** 對話方塊 \(**檔案**, ，**原始檔控制**, ，**變更原始檔控制**\)。<br />4.  將方案繫結至原始檔控制中的空白位置。<br />5.  按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />6.  按一下 \[ **繼續使用這些繫結** 在確認對話方塊。<br />7.  按一下 \[ **確定** 警告對話方塊中顯示。|方案會隨即加入至原始檔控制。<br /><br /> 方案和專案未簽出。|  
|取消繫結|1.  建立專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  開啟 \[變更原始檔控制\] 對話方塊。<br />4.  解除所有繫結。<br />5.  按一下 \[ **確定** \] 按鈕以關閉對話方塊。 如果這個步驟成功，請繼續下一個步驟。<br />6.  重新開啟 **變更原始檔控制** 對話方塊。<br />7.  繫結至不相關的位置。<br />8.  按一下 \[**取消**\]。|`Result from Step 5:`<br /><br /> 此方案不會再受到原始檔控制<br /><br /> `Result from Step 8:`<br /><br /> 解決方案是仍不會在原始檔控制。|  
  
### Case 5b︰ 解除繫結。  
 解除繫結移除來源的程式碼從專案和方案的控制項資訊。 受影響的專案和方案根據使用者選取和方式的項目已加入至原始檔控制的混合。  
  
|動作|測試步驟|若要確認預期的結果|  
|--------|----------|---------------|  
|解除繫結包含一個檔案系統或本機 IIS Web 專案和一個用戶端專案的方案|1.  建立檔案系統或本機 IIS Web 專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  將新的用戶端專案加入方案。<br />4.  如果出現提示，接受簽出的方案。<br />5.  開啟 **變更原始檔控制** 對話方塊。<br />6.  按一下 \[ **解除繫結**。<br />7.  按一下 \[ **確定** 以關閉對話方塊。<br />8.  嘗試簽出方案、 專案、 方案項目、 專案項目。|方案和專案不是原始檔控制下。<br /><br /> 不會出現原始檔控制功能表命令。|  
|取消解除繫結|1.  建立專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  開啟 **變更原始檔控制** 對話方塊。<br />4.  按一下 \[ **解除繫結所有**。<br />5.  按一下 \[**取消**\]。|解決方案是原始檔控制下。|  
  
### 案例 5 c︰ 重新繫結  
 重新繫結是只要解除繫結和繫結的組合，重新繫結專案\/方案先前已在原始檔控制，而且已解除繫結的程序。  
  
|動作|測試步驟|若要確認預期的結果|  
|--------|----------|---------------|  
|重新繫結方案和專案，而不必關閉 **變更原始檔控制** 對話方塊|1.  建立專案。<br />2.  您可以將方案加入原始檔控制。<br />3.  開啟 **變更原始檔控制** 對話方塊。<br />4.  按一下 \[ **解除繫結**。<br />5.  選取所有資料列。<br />6.  按一下 \[ **繫結**。<br />7.  按一下 \[ **確定** 關閉 **變更原始檔控制** 對話方塊。<br />8.  如果系統提示您，接受簽出。|方案和專案的原始檔控制下。|  
|只需關閉專案重新繫結 **變更原始檔控制** 對話方塊|1.  建立專案。<br />2.  只有專案加入原始檔控制使用 \(檔案\]\-\> \[原始檔控制\]\-\> \[新增所選專案加入原始檔控制。<br />3.  開啟 \[變更原始檔控制\] 對話方塊。<br />4.  解除繫結的專案。<br />5.  繫結的專案。|解決方案會維持未受控制的。<br /><br /> 專案仍會保留控制。|  
|只需關閉方案重新繫結 **變更原始檔控制** 對話方塊|1.  建立專案。<br />2.  只有方案加入原始檔控制使用 \(**檔案**, ，**原始檔控制**, ，**將所選專案加入至原始檔控制**。<br />3.  開啟 **變更原始檔控制** 對話方塊。<br />4.  解除繫結的方案 \(不會關閉 **變更原始檔控制** 對話方塊。\)<br />5.  繫結的解決方案。<br />6.  按一下 \[**確定**\] 關閉對話方塊。<br />7.  簽出方案和方案項目 （如果有的話。）|方案仍受控制的。<br /><br /> 專案會維持未受控制的。|  
|只有當同一個目錄中的方案\/專案重新繫結|1.  建立專案。<br />2.  只有專案加入原始檔控制使用 \(**檔案**, ，**原始檔控制**, ，**將所選專案加入至原始檔控制**。<br />3.  關閉方案。<br />4.  使用至少兩個專案中建立新的方案。<br />5.  您可以將方案加入原始檔控制。<br />6.  加入在步驟 1 中從原始檔控制所建立的專案。<br />7.  如果系統提示您，接受簽出的方案。<br />8.  整個方案簽入。<br />9. 開啟 **變更原始檔控制** 對話方塊。<br />10. 選取 \[新增的專案 （從步驟 6\)，然後按一下 **解除繫結**。<br />11. 按一下 \[**確定**\] 關閉對話方塊。<br />12. 如果系統提示您，接受簽出。<br />13. 重新開啟 **變更原始檔控制** 對話方塊。<br />14. 選取 \[新增的專案 （從步驟 6\)，然後按一下 **繫結**。<br />15. 選取的原始位置。|方案和專案保持控制。|  
  
## 請參閱  
 [原始檔控制外掛程式的測試指南](../../extensibility/internals/test-guide-for-source-control-plug-ins.md)