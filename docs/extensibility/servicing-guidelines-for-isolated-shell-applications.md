---
title: "獨立的 Shell 應用程式服務的指導方針 | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Visual Studio Shell 整合的模式中，服務性"
  - "Shell 整合的模式 [Visual Studio]，服務性"
ms.assetid: 747d1a47-b8b3-4e8b-93c0-768724be48f2
caps.latest.revision: 15
caps.handback.revision: 15
ms.author: "gregvanl"
manager: "ghogen"
---
# 獨立的 Shell 應用程式服務的指導方針
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

當您發佈的 Visual Studio 隔離 shell 應用程式時，您必須在安裝之後，您的應用程式提供軟體更新。 若要這樣做，您必須使用 Microsoft Installer \(MSI\) 檔案來安裝您的應用程式。 這種安裝可讓 Microsoft 可轉散發 Web 所提供的軟體更新下載，而且由您的客戶不需要自訂的介入。  
  
## 服務的需求  
 您可以確保獨立的 shell 安裝可允許更新，以確定您的安裝程式符合下列三個準則。  
  
### 使用 MSI 轉散發  
 您必須使用 MSI 重新發佈您的應用程式，因為 MSI 保留產品身分識別，並可確保應用程式用戶端電腦上的實體位置。 合併模組 （.msm 檔案） 不提供這類保證，不應使用。  
  
### 帳戶處理的自訂動作  
 自訂動作是在安裝程式中的非標準的安裝指示詞。 自訂動作變更參數，例如檔案位置、 登錄設定、 使用者設定或安裝的其他項目。 自訂動作可能會在安裝期間操作資料。  
  
 當您在安裝程式中使用自訂動作時，您必須確定每個安裝階段的自訂動作，必須具有對應的自訂動作，以復原的動作，當使用者解除安裝應用程式。 如果提供對應程式安裝程式無法解除安裝自訂動作，移除您的應用程式將不安裝一部分。  
  
-   當軟體更新會變更這些版本，或者雜湊值，自訂動作所使用的特定版本的檔案或雜湊值將會失敗。 在此情況下您的自訂動作，必須手動更新這些值。 如果產品版本之間共用檔案或雜湊值的版本，就會發生其他問題。 避免盡可能此相依性。  
  
### 帳戶處理共用檔案  
 共用的檔案有相同的名稱，並由多個產品安裝到相同的位置。 在版本、 存貨保持單元 \(SKU\)，或兩者，可能不同這些產品和產品可以同時存在指定的電腦上。 但是，共用的檔案發生服務問題的原因有多種︰  
  
-   更新共用的檔案可能會導致應用程式相容性問題，因為一個應用程式的更新可能會變更尚未更新的第二個應用程式所使用的檔案版本。 共用檔案的產品的安裝計數的共用檔案的參考。 因此，解除安裝產品不會影響已安裝的執行個體計數遞減超過共用的檔案。  
  
-   快速檢修 \(QFE\) 安裝程式會還原檔案的 QFE 安裝程式服務的產品版本的版本。 此程序可能會中斷應用程式傳送更新的共用的檔案。